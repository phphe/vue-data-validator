/*!
 * vue-data-validator v2.2.7
 * (c) 2017-present phphe <phphe@outlook.com> (https://github.com/phphe)
 * Released under the MIT License.
 */
!function(e,a){"object"==typeof exports&&"undefined"!=typeof module?a(exports):"function"==typeof define&&define.amd?define(["exports"],a):a(e.vueDataValidator={})}(this,function(e){"use strict";function a(e){return"[object Array]"===Object.prototype.toString.call(e)}function r(e){return"[object String]"===Object.prototype.toString.call(e)}function t(e){return"function"==typeof e}function n(e){return null==e||(null!=e.length?0===e.length:!function(e){return"[object Boolean]"===Object.prototype.toString.call(e)}(e)&&(function(e){return"[object Number]"===Object.prototype.toString.call(e)}(e)?isNaN(e):function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e)?0===Object.keys(e).length:void 0))}function i(e){return{storage:e,set:function(e,a,r){null==a?this.storage.removeItem(e):this.storage.setItem(e,JSON.stringify({value:a,expired_at:r&&(new Date).getTime()/1e3+60*r}))},get:function(e){var a=this.storage.getItem(e);if(a){if(!(a=JSON.parse(a)).expired_at||a.expired_at>(new Date).getTime())return a.value;this.storage.removeItem(e)}return null},clear:function(){this.storage.clear()}}}i(window.localStorage),i(window.sessionStorage);var s={rules:{},messages:{},validClass:"has-success",invalidClass:"has-error",validtingClass:"",install:function(e){e.validator=e.prototype.$validator=this,e.prototype.$validate=function(a,r){return e.validator.validate(a,r,this)}},validate:function(e,a,r){var t=this;return e.clear&&e.clear(),this.initValidation(e,a,r),this.initFields(e,r),Object.values(a).forEach(function(a){return t.validateField(a,e)}),e},initValidation:function(e,a,r){var t={fields:a,dirty:!1,valid:!1,validating:!1,isPause:!1,_sensitiveFields:[],vm:r,isSubmitAble:function(){return this.valid&&!this.validating},getValues:function(){return function(e,a){var r={};for(var t in e)r[t]=a(e[t],t,e);return r}(this.fields,function(e){return e.value})},setValues:function(e){for(var a in e)this.fields.hasOwnProperty(a)&&(this.fields[a].value=e[a]);return this},setDirty:function(e){return this.dirty=e,Object.values(this.fields).forEach(function(a){a.dirty=e}),this},check:function(){var e=this;return new Promise(function(a,r){return e.validating&&(e._checkResolves||(e._checkResolves=[])),(e.validating?new Promise(function(a,r){e._checkResolves.push(a)}):Promise.resolve()).then(function(){e.valid?a(e.getValues()):(e.setDirty(!0),r(new Error("invalid")))})})},unwatch:function(){return Object.values(this.fields).forEach(function(e){e.watcher&&e.watcher.unwatch&&e.watcher.unwatch()}),this},pause:function(){return this.isPause=!0,this},continue:function(){return this.isPause=!1,this},clear:function(){return this.unwatch(),this.setDirty(!1),Object.values(this.fields).forEach(function(e){e.required=!1}),this},revalidate:function(){return r.$validate(this,this.fields)},getFirstError:function(){var e=Object.values(this.fields).find(function(e){return Object.values(e.errors)[0]});return e&&Object.values(e.errors)[0]},getErrors:function(){var e=[];return Object.values(this.fields).forEach(function(a){Object.values(a.errors).forEach(function(a){e.push(a)})}),e}};for(var n in t)r.$set(e,n,t[n])},initFields:function(e,a){var r=this,t=function(t){var n=e.fields[t];if(n.name){if(n.name!==t)throw Error("The field name must be same with its key.")}else a.$set(n,"name",t);n.nameInMessage||(n.nameInMessage=l(n)),a.$set(n,"value",void 0!==n.value?n.value:null),a.$set(n,"dirty",!1),a.$set(n,"valid",!1),a.$set(n,"errors",{}),a.$set(n,"required",!1),a.$set(n,"validating",!1),a.$set(n,"_resolvedRules",r.resolveRules(n)),a.$set(n,"isValidationErrorsVisible",function(){return n.rules&&!n.validating&&n.dirty&&!n.valid}),a.$set(n,"getValidationClass",function(){return n.rules&&n.dirty?n.validating?r.validatingClass:n.valid?r.validClass:r.invalidClass:null}),Object.values(n._resolvedRules).find(function(e){return e.sensitive})&&e._sensitiveFields.push(n);var i={getValue:function(){return n.value},handler:function(a){e.isPause||(n._ignoreDirtyOnce?n._ignoreDirtyOnce=!1:(n.dirty=!0,e.dirty=!0),r.validateField(n,e),e._sensitiveFields.filter(function(e){return e!==n}).forEach(function(a){r.validateField(a,e)}))}};i.unwatch=a.$watch(i.getValue,i.handler,{deep:n.deep}),a.$set(n,"watcher",i)};for(var n in e.fields)t(n)},resolveRules:function(e){var a={};if(e.rules){var r=e.rules.split("|");for(var n in r){var i=r[n].split(":"),s=i[1]?i[1].split(","):[],l=i[0];e.ruleParams&&e.ruleParams[l]&&(s=s.concat(e.ruleParams[l]));var u=e.customRules&&e.customRules[l]||this.rules[l];if(t(u)&&(u={handler:u}),null==u)throw Error("Rule '".concat(l,"' of field '").concat(e.name,"' is not found."));a[l]={name:l,params:s,required:u.required,sensitive:u.sensitive,handler:u.handler,message:e.messages&&e.messages[l]||this.messages&&this.messages[l]||"No error message for :name."}}}return a},validateField:function(e,a){var r=this,t={};e._validationId=t,a.validating=!0,e.validating=!0,this.removeFieldAllErrors(e,a);for(var n=Object.values(e._resolvedRules),i=Promise.resolve(!0),s=function(){var s=n[l];i=i.then(function(){return r.validateRule(s,e,a,t)})},l=0;l<n.length;l++)s();i.then(function(){return!0}).catch(function(e){return"expired"!==e.message}).then(function(r){r&&(e._validationId=null,e.validating=!1,a.validating=Object.values(a.fields).some(function(e){return e.validating}),a.validating||a._checkResolves&&(a._checkResolves.forEach(function(e){e()}),a._checkResolves=null))})},validateRule:function(e,a,r,i){var s=this;return null!=e.required&&(a.required=t(e.required)?e.required({value:a.value,params:e.params,field:a,fields:r.fields,validation:r,Vue:r.vm.$root.constructor}):e.required),new Promise(function(t,l){if(a.required||!n(a.value)){var u=e.handler({value:a.value,params:e.params,field:a,fields:r.fields,validation:r,Vue:r.vm.$root.constructor});o=u,"[object Promise]"!==Object.prototype.toString.call(o)&&(u=u?Promise.resolve():Promise.reject(new Error("invalid"))),u.then(function(){i!==a._validationId&&l(new Error("expired")),s.removeFieldError(e,a,r),t()}).catch(function(t){i!==a._validationId&&l(new Error("expired")),s.addFieldError(e,a,r),l(t)})}else t();var o})},addFieldError:function(e,a,r){var n=function(e,a,r){var n=a.nameInMessage,i=t(e.message)?e.message({value:a.value,params:e.params,field:a,fields:r.fields,validation:r,Vue:Vue}):e.message;for(var s in i=i.replace(/:name/g,n).replace(/:value/g,a.value),e.params){var u=new RegExp(":params\\["+s+"\\]","g");i=i.replace(u,e.params[s])}var o=i.match(/:fieldName\(.+?\)/g);if(o){var d=!0,m=!1,v=void 0;try{for(var c,f=o[Symbol.iterator]();!(d=(c=f.next()).done);d=!0){var h=c.value,p=h.match(/\((.+)\)/)[1],g=r.fields[p];g||console.warn("vue-data-validator: error when generate error message. Can't found field ".concat(p,". Current field is ").concat(a.name,"."));var b=g?l(g):"";i=i.replace(h,b)}}catch(e){m=!0,v=e}finally{try{d||null==f.return||f.return()}finally{if(m)throw v}}}return i}(e,a,r);if(!a.errors[e.name]){var i={};for(var s in a._resolvedRules)a.errors[s]?i[s]=a.errors[s]:s===e.name&&(i[s]={});a.errors=i}a.errors[e.name]={name:e.name,message:n,field:a},a.valid=!1,r.valid=!1},removeFieldError:function(e,a,r){var t={};for(var n in a.errors)n!==e.name&&(t[n]=a.errors[n]);a.errors=t,a.valid=0===Object.keys(a.errors).length,r.valid=Object.values(r.fields).every(function(e){return e.valid})},removeFieldAllErrors:function(e,a){e.errors={},e.valid=!0,a.valid=Object.values(a.fields).every(function(e){return e.valid})}};function l(e){return e.nameInMessage||e.text&&e.text.toString().toLowerCase()||e.name||"unnamed"}var u={accepted:function(e){var a=e.value;return"yes"===a||"on"===a||!0===a||1===a||"1"===a},alpha:function(e){var a=e.value;return/^[a-zA-Z]+$/.test(a)},alphaDash:function(e){var a=e.value;return/^[\w-]+$/.test(a)},alphaNum:function(e){var a=e.value;return/^[\w]+$/.test(a)},between:function(e){var a=e.value,r=e.params;return r[0]<=a&&r[1]<=a},boolean:function(e){var a=e.value;return[!0,!1,1,0,"1","0"].includes(a)},date:function(e){var a=e.value;return/^\d\d\d\d-\d\d?-\d\d?$/.test(a)},datetime:function(e){var a=e.value;return/^\d\d\d\d-\d\d?-\d\d? \d\d?:\d\d?:\d\d?$/.test(a)},different:{handler:function(e){var a=e.value,r=e.params;e.field;return a!==e.fields[r[0]].value},sensitive:!0},email:function(e){var a=e.value;return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)},in:function(e){var r=e.value,t=e.params;return(a(t[0])?t[0]:t).indexOf(r)>-1},integer:function(e){var a=e.value;return/^\-?\d+$/.test(a)},length:function(e){var a=e.value,r=e.params;return(a||"").length===parseInt(r[0])},lengthBetween:function(e){var a=e.value,r=e.params,t=(a||"").length;return r[0]<=t&&t<=r[1]},max:function(e){return e.value<=e.params[0]},maxLength:function(e){var a=e.value,r=e.params;return(a||"").length<=r[0]},min:function(e){return e.value>=e.params[0]},minLength:function(e){var a=e.value,r=e.params;return(a||"").length>=r[0]},notIn:function(e){var r=e.value,t=e.params;return-1===(a(t[0])?t[0]:t).indexOf(r)},numeric:function(e){var a=e.value;return isFinite(a)},regex:function(e){var a=e.value,t=e.params;return(r(t[0])?new RegExp(t[0]):t[0]).test(a)},required:{handler:function(e){var a=e.value;e.params,e.field;return!n(a)},required:!0},requiredWith:{handler:function(e){return!n(e.value)},sensitive:!0,required:function(e){e.value;var a=e.params;e.field;return!n(e.fields[a[0]].value)}},requiredIf:{handler:function(e){return!n(e.value)},sensitive:!0,required:function(e){return e.params[0](e)}},same:{handler:function(e){var a=e.value,r=e.params;e.field;return a===e.fields[r[0]].value},sensitive:!0},size:function(e){var a=e.value,r=e.params;return(a||"").length===parseInt(r[0])},string:function(e){return r(e.value)},remoteCheck:function(e){var r=e.value,t=e.params,n=(e.field,e.fields,e.validation,e.Vue);if((a(t[1])?t[1]:[t[1]]).includes(r))return!0;var i=t[0];return n.http.post(i,{value:r}).then(function(e){return e.data?Promise.resolve():Promise.reject(new Error("invalid"))})},remoteNotExisted:function(e){return u.remoteCheck(e)}};e.validator=s,e.rules=u,e.enMessages={accepted:"The :name must be accepted.",alpha:"The :name may only contain letters.",alphaDash:"The :name may only contain letters, numbers, and dashes.",alphaNum:"The :name may only contain letters and numbers.",between:"The :name must be between :fieldName(:params[0]) and :fieldName(:params[1]).",boolean:"The :name field must be true or false.",date:"The :name is not a valid date.",datetime:"The :name is not a valid datetime.",different:"The :name and :fieldName(:params[0]) must be different.",email:"The :name must be a valid email address.",in:"The selected :name is invalid.",integer:"The :name must be an integer.",length:"The :name length must be :params[0].",lengthBetween:"The :name length must be between :params[0] and :params[1].",max:"The :name may not be greater than :params[0].",maxLength:"The :name length may not be greater than :params[0].",min:"The :name must be at least :params[0].",minLength:"The :name length must be at least :params[0].",notIn:"The selected :name is invalid.",numeric:"The :name must be a number.",regex:"The :name format is invalid.",required:"The :name field is required.",requiredWith:"The :name field is required when :fieldName(:params[0]) is present.",requiredIf:"The :name field is required.",same:"The :name and :fieldName(:params[0]) must match.",size:"The :name length must be :params[0].",string:"The :name must be a string.",remoteCheck:"The :name is invalid.",remoteNotExisted:"The :name already exists."},e.zhCNMessages={accepted:"您必须同意:name才能继续。",alpha:":name仅能包含字母。",alphaDash:":name仅能包含字母，数字，破折号和下划线。",alphaNum:":name仅能包含字母和数字。",between:":name必须在:fieldName(:params[0])和:fieldName(:params[1])之间。",boolean:":name必须为true或false。",date:":name必须是一个正确格式的日期。",datetime:":name必须是一个正确格式的日期时间。",different:":name不能与:fieldName(:params[0])相同。",email:":name不是一个正确的邮箱。",in:"选择的:name不可用。",integer:":name必须是整数。",length:":name的长度必须是:params[0]。",lengthBetween:":name的长度须在:params[0]和:params[1]之间。",max:":name不能超过:params[0]。",maxLength:":name的长度不能超过:params[0]。",min:":name不能低于:params[0]。",minLength:":name的长度不能低于:params[0]。",notIn:"选择的:name不可用。",numeric:":name不是一个正确的数字。",regex:":name格式错误。",required:"请填写:name。",requiredWith:"请填写:name。当:fieldName(:params[0])不为空时，:name必填。",requiredIf:"请填写:name。",same:":name必须与:fieldName(:params[0])相同。",size:":name的长度必须是:params[0]。",string:":name必须是字符串。",remoteCheck:":name错误。",remoteNotExisted:":name已存在。"},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=vue-data-validator.min.js.map
