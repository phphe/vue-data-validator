/*!
 * vue-data-validator v2.2.5
 * phphe <phphe@outlook.com> (https://github.com/phphe)
 * https://github.com/phphe/vue-data-validator.git
 * Released under the MIT License.
 */

!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(e.vueDataValidator=e.vueDataValidator||{})}(this,function(e){"use strict";function r(e){return void 0!==e}function a(e){return"[object Array]"===Object.prototype.toString.call(e)}function n(e){return"[object Boolean]"===Object.prototype.toString.call(e)}function t(e){return"[object Number]"===Object.prototype.toString.call(e)}function i(e){return isFinite(e)}function s(e){return"[object String]"===Object.prototype.toString.call(e)}function u(e){return"[object Object]"===Object.prototype.toString.call(e)}function l(e){return"function"==typeof e}function o(e){return"[object Promise]"===Object.prototype.toString.call(e)}function d(e){return null==e||(null!=e.length?0===e.length:!n(e)&&(t(e)?isNaN(e):u(e)?0===Object.keys(e).length:void 0))}function m(e,r){var a={};for(var n in e)a[n]=r(e[n],n,e);return a}function c(e){return function(){var r=e.apply(this,arguments);return new Promise(function(e,a){function n(t,i){try{var s=r[t](i),u=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)});e(u)}return n("next")})}}function v(e){return e.nameInMessage||e.text&&e.text.toString().toLowerCase()||e.name||"unnamed"}function f(e,r,a){var n=r.nameInMessage,t=l(e.message)?e.message({value:r.value,params:e.params,field:r,fields:a.fields,validation:a,Vue:Vue}):e.message;t=t.replace(/:name/g,n).replace(/:value/g,r.value);for(var i in e.params){var s=new RegExp(":params\\["+i+"\\]","g");t=t.replace(s,e.params[i])}var u=t.match(/:fieldName\(.+?\)/g);if(u){var o=!0,d=!1,m=void 0;try{for(var c,f=u[Symbol.iterator]();!(o=(c=f.next()).done);o=!0){var h=c.value,p=h.match(/\((.+)\)/)[1],g=a.fields[p];g||console.warn("vue-data-validator: error when generate error message. Can't found field "+p+". Current field is "+r.name+".");var b=g?v(g):"";t=t.replace(h,b)}}catch(e){d=!0,m=e}finally{try{!o&&f.return&&f.return()}finally{if(d)throw m}}}return t}var h={rules:{},messages:{},validClass:"has-success",invalidClass:"has-error",validtingClass:"",install:function(e){e.validator=e.prototype.$validator=this,e.prototype.$validate=function(r,a){return e.validator.validate(r,a,this)}},validate:function(e,r,a){var n=this;return e.clear&&e.clear(),this.initValidation(e,r,a),this.initFields(e,a),Object.values(r).forEach(function(r){return n.validateField(r,e)}),e},initValidation:function(e,r,a){var n={fields:r,dirty:!1,valid:!1,validating:!1,isPause:!1,_sensitiveFields:[],vm:a,isSubmitAble:function(){return this.valid&&!this.validating},getValues:function(){return m(this.fields,function(e){return e.value})},setValues:function(e){for(var r in e)this.fields.hasOwnProperty(r)&&(this.fields[r].value=e[r]);return this},setDirty:function(e){return this.dirty=e,Object.values(this.fields).forEach(function(r){r.dirty=e}),this},check:function(){var e=this;return new Promise(function(){var r=c(regeneratorRuntime.mark(function r(a,n){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e.validating){r.next=5;break}return e._checkResolves||(e._checkResolves=[]),t=new Promise(function(r,a){e._checkResolves.push(r)}),r.next=5,t;case 5:e.valid?a(e.getValues()):(e.setDirty(!0),n(new Error("invalid")));case 6:case"end":return r.stop()}},r,e)}));return function(e,a){return r.apply(this,arguments)}}())},unwatch:function(){return Object.values(this.fields).forEach(function(e){e.watcher&&e.watcher.unwatch&&e.watcher.unwatch()}),this},pause:function(){return this.isPause=!0,this},continue:function(){return this.isPause=!1,this},clear:function(){return this.unwatch(),this.setDirty(!1),Object.values(this.fields).forEach(function(e){e.required=!1}),this},revalidate:function(){return a.$validate(this,this.fields)},getFirstError:function(){var e=Object.values(this.fields).find(function(e){return Object.values(e.errors)[0]});return e&&Object.values(e.errors)[0]},getErrors:function(){var e=[];return Object.values(this.fields).forEach(function(r){Object.values(r.errors).forEach(function(r){e.push(r)})}),e}};for(var t in n)a.$set(e,t,n[t])},initFields:function(e,a){var n=this;for(var t in e.fields)!function(t){var i=e.fields[t];if(i.name){if(i.name!==t)throw Error("The field name must be same with its key.")}else a.$set(i,"name",t);i.nameInMessage||(i.nameInMessage=v(i)),a.$set(i,"value",r(i.value)?i.value:null),a.$set(i,"dirty",!1),a.$set(i,"valid",!1),a.$set(i,"errors",{}),a.$set(i,"required",!1),a.$set(i,"validating",!1),a.$set(i,"_resolvedRules",n.resolveRules(i)),a.$set(i,"isValidationErrorsVisible",function(){return i.rules&&!i.validating&&i.dirty&&!i.valid}),a.$set(i,"getValidationClass",function(){return i.rules&&i.dirty?i.validating?n.validatingClass:i.valid?n.validClass:n.invalidClass:null}),Object.values(i._resolvedRules).find(function(e){return e.sensitive})&&e._sensitiveFields.push(i);var s={getValue:function(){return i.value},handler:function(r){e.isPause||(i._ignoreDirtyOnce?i._ignoreDirtyOnce=!1:(i.dirty=!0,e.dirty=!0),n.validateField(i,e),e._sensitiveFields.filter(function(e){return e!==i}).forEach(function(r){n.validateField(r,e)}))}};s.unwatch=a.$watch(s.getValue,s.handler,{deep:i.deep}),a.$set(i,"watcher",s)}(t)},resolveRules:function(e){var r={};if(e.rules){var a=e.rules.split("|");for(var n in a){var t=a[n].split(":"),i=t[1]?t[1].split(","):[],s=t[0];e.ruleParams&&e.ruleParams[s]&&(i=i.concat(e.ruleParams[s]));var u=e.customRules&&e.customRules[s]||this.rules[s];if(l(u)&&(u={handler:u}),null==u)throw Error("Rule '"+s+"' of field '"+e.name+"' is not found.");r[s]={name:s,params:i,required:u.required,sensitive:u.sensitive,handler:u.handler,message:e.messages&&e.messages[s]||this.messages&&this.messages[s]||"No error message for :name."}}}return r},validateField:function(e,r){var a=this,n={};e._validationId=n,r.validating=!0,e.validating=!0,this.removeFieldAllErrors(e,r);var t=Object.values(e._resolvedRules),i=Promise.resolve(!0),s=!0,u=!1,l=void 0;try{for(var o,d=t[Symbol.iterator]();!(s=(o=d.next()).done);s=!0){var m=o.value;!function(t){i=i.then(function(){return a.validateRule(t,e,r,n)})}(m)}}catch(e){u=!0,l=e}finally{try{!s&&d.return&&d.return()}finally{if(u)throw l}}i.then(function(){return!0}).catch(function(e){return"expired"!==e.message}).then(function(a){a&&(e._validationId=null,e.validating=!1,r.validating=Object.values(r.fields).some(function(e){return e.validating}),r.validating||r._checkResolves&&(r._checkResolves.forEach(function(e){e()}),r._checkResolves=null))})},validateRule:function(e,r,a,n){var t=this;return null!=e.required&&(r.required=l(e.required)?e.required({value:r.value,params:e.params,field:r,fields:a.fields,validation:a,Vue:a.vm.$root.constructor}):e.required),new Promise(function(i,s){if(r.required||!d(r.value)){var u=e.handler({value:r.value,params:e.params,field:r,fields:a.fields,validation:a,Vue:a.vm.$root.constructor});o(u)||(u=u?Promise.resolve():Promise.reject(new Error("invalid"))),u.then(function(){n!==r._validationId&&s(new Error("expired")),t.removeFieldError(e,r,a),i()}).catch(function(i){n!==r._validationId&&s(new Error("expired")),t.addFieldError(e,r,a),s(i)})}else i()})},addFieldError:function(e,r,a){var n=f(e,r,a);if(!r.errors[e.name]){var t={};for(var i in r._resolvedRules)r.errors[i]?t[i]=r.errors[i]:i===e.name&&(t[i]={});r.errors=t}r.errors[e.name]={name:e.name,message:n,field:r},r.valid=!1,a.valid=!1},removeFieldError:function(e,r,a){var n={};for(var t in r.errors)t!==e.name&&(n[t]=r.errors[t]);r.errors=n,r.valid=0===Object.keys(r.errors).length,a.valid=Object.values(a.fields).every(function(e){return e.valid})},removeFieldAllErrors:function(e,r){e.errors={},e.valid=!0,r.valid=Object.values(r.fields).every(function(e){return e.valid})}},p={accepted:function(e){var r=e.value;return"yes"===r||"on"===r||!0===r||1===r||"1"===r},alpha:function(e){return/^[a-zA-Z]+$/.test(e.value)},alphaDash:function(e){return/^[\w-]+$/.test(e.value)},alphaNum:function(e){return/^[\w]+$/.test(e.value)},between:function(e){var r=e.value,a=e.params;return a[0]<=r&&a[1]<=r},boolean:function(e){return[!0,!1,1,0,"1","0"].includes(e.value)},date:function(e){return/^\d\d\d\d-\d\d?-\d\d?$/.test(e.value)},datetime:function(e){return/^\d\d\d\d-\d\d?-\d\d? \d\d?:\d\d?:\d\d?$/.test(e.value)},different:{handler:function(e){var r=e.value,a=e.params;e.field;return r!==e.fields[a[0]].value},sensitive:!0},email:function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.value)},in:function(e){var r=e.value,n=e.params;return(a(n[0])?n[0]:n).indexOf(r)>-1},integer:function(e){return/^\-?\d+$/.test(e.value)},length:function(e){var r=e.value,a=e.params;return(r||"").length===parseInt(a[0])},lengthBetween:function(e){var r=e.value,a=e.params,n=(r||"").length;return a[0]<=n&&n<=a[1]},max:function(e){return e.value<=e.params[0]},maxLength:function(e){var r=e.value,a=e.params;return(r||"").length<=a[0]},min:function(e){return e.value>=e.params[0]},minLength:function(e){var r=e.value,a=e.params;return(r||"").length>=a[0]},notIn:function(e){var r=e.value,n=e.params;return-1===(a(n[0])?n[0]:n).indexOf(r)},numeric:function(e){return i(e.value)},regex:function(e){var r=e.value,a=e.params;return(s(a[0])?new RegExp(a[0]):a[0]).test(r)},required:{handler:function(e){var r=e.value;e.params,e.field;return!d(r)},required:!0},requiredWith:{handler:function(e){return!d(e.value)},sensitive:!0,required:function(e){var r=(e.value,e.params);e.field;return!d(e.fields[r[0]].value)}},requiredIf:{handler:function(e){return!d(e.value)},sensitive:!0,required:function(e){return e.params[0](e)}},same:{handler:function(e){var r=e.value,a=e.params;e.field;return r===e.fields[a[0]].value},sensitive:!0},size:function(e){var r=e.value,a=e.params;return(r||"").length===parseInt(a[0])},string:function(e){return s(e.value)},remoteCheck:function(e){var r=e.value,n=e.params,t=(e.field,e.fields,e.validation,e.Vue);if((a(n[1])?n[1]:[n[1]]).includes(r))return!0;var i=n[0];return t.http.post(i,{value:r}).then(function(e){return e.data?Promise.resolve():Promise.reject(new Error("invalid"))})},remoteNotExisted:function(e){return p.remoteCheck(e)}},g={accepted:"The :name must be accepted.",alpha:"The :name may only contain letters.",alphaDash:"The :name may only contain letters, numbers, and dashes.",alphaNum:"The :name may only contain letters and numbers.",between:"The :name must be between :fieldName(:params[0]) and :fieldName(:params[1]).",boolean:"The :name field must be true or false.",date:"The :name is not a valid date.",datetime:"The :name is not a valid datetime.",different:"The :name and :fieldName(:params[0]) must be different.",email:"The :name must be a valid email address.",in:"The selected :name is invalid.",integer:"The :name must be an integer.",length:"The :name length must be :params[0].",lengthBetween:"The :name length must be between :params[0] and :params[1].",max:"The :name may not be greater than :params[0].",maxLength:"The :name length may not be greater than :params[0].",min:"The :name must be at least :params[0].",minLength:"The :name length must be at least :params[0].",notIn:"The selected :name is invalid.",numeric:"The :name must be a number.",regex:"The :name format is invalid.",required:"The :name field is required.",requiredWith:"The :name field is required when :fieldName(:params[0]) is present.",requiredIf:"The :name field is required.",same:"The :name and :fieldName(:params[0]) must match.",size:"The :name length must be :params[0].",string:"The :name must be a string.",remoteCheck:"The :name is invalid.",remoteNotExisted:"The :name already exists."},b={accepted:"您必须同意:name才能继续。",alpha:":name仅能包含字母。",alphaDash:":name仅能包含字母，数字，破折号和下划线。",alphaNum:":name仅能包含字母和数字。",between:":name必须在:fieldName(:params[0])和:fieldName(:params[1])之间。",boolean:":name必须为true或false。",date:":name必须是一个正确格式的日期。",datetime:":name必须是一个正确格式的日期时间。",different:":name不能与:fieldName(:params[0])相同。",email:":name不是一个正确的邮箱。",in:"选择的:name不可用。",integer:":name必须是整数。",length:":name的长度必须是:params[0]。",lengthBetween:":name的长度须在:params[0]和:params[1]之间。",max:":name不能超过:params[0]。",maxLength:":name的长度不能超过:params[0]。",min:":name不能低于:params[0]。",minLength:":name的长度不能低于:params[0]。",notIn:"选择的:name不可用。",numeric:":name不是一个正确的数字。",regex:":name格式错误。",required:"请填写:name。",requiredWith:"请填写:name。当:fieldName(:params[0])不为空时，:name必填。",requiredIf:"请填写:name。",same:":name必须与:fieldName(:params[0])相同。",size:":name的长度必须是:params[0]。",string:":name必须是字符串。",remoteCheck:":name错误。",remoteNotExisted:":name已存在。"};e.validator=h,e.rules=p,e.enMessages=g,e.zhCNMessages=b,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=vue-data-validator.min.js.map